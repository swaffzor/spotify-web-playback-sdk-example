(this["webpackJsonpweb-playback-sdk-sample-app"]=this["webpackJsonpweb-playback-sdk-sample-app"]||[]).push([[0],{10:function(e,t,a){},11:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),c=a(3),i=a.n(c),o=a(0);const r={name:"",album:{images:[{url:""}]},artists:[{name:""}]};var l=function(e){var t;let{token:a,playlistId:n,setPlaylistId:c}=e;const[i,l]=Object(s.useState)(!1),[d,p]=Object(s.useState)(!1),[j,u]=Object(s.useState)(void 0),[b,h]=Object(s.useState)(r),[m,y]=Object(s.useState)({name:"",owner:""}),[O,g]=Object(s.useState)([]),[x,v]=Object(s.useState)(""),[w,k]=Object(s.useState)("");return Object(s.useEffect)((()=>{const e=document.createElement("script");e.src="https://sdk.scdn.co/spotify-player.js",e.async=!0,document.body.appendChild(e),window.onSpotifyWebPlaybackSDKReady=()=>{const e=new Date,t=new window.Spotify.Player({name:`Composer POC ${e.getHours()}:${e.getMinutes()} ${e.getSeconds()}`,getOAuthToken:e=>{e(a)},volume:.5});u(t),t.addListener("ready",(e=>{let{device_id:t}=e;console.log("Ready with Device ID",t),v(t)})),t.addListener("not_ready",(e=>{let{device_id:t}=e;console.log("Device ID has gone offline",t)})),t.addListener("player_state_changed",(e=>{e&&(h(e.track_window.current_track),l(e.paused),t.getCurrentState().then((e=>{p(!!e)})))})),t.connect()}}),[a]),Object(s.useEffect)((()=>{if(!n)return;(async()=>{const e=await fetch(`https://api.spotify.com/v1/playlists/${n}`,{headers:{Authorization:`Bearer ${a}`}});401===e.status&&(console.error("Token expired, redirecting to login"),window.location.href="/auth/login");const t=await e.json();g(t.tracks.items),y({name:t.name,owner:t.owner.display_name})})()}),[n,a]),Object(o.jsxs)("div",{children:[Object(o.jsxs)("div",{className:"main-wrapper",children:[Object(o.jsx)("div",{className:"now-playing sticky",style:{},children:d?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("img",{src:null===(t=b.album.images[0])||void 0===t?void 0:t.url,className:"now-playing__cover",alt:""}),Object(o.jsxs)("div",{className:"now-playing__side",children:[Object(o.jsx)("div",{className:"now-playing__name",children:b.name}),Object(o.jsx)("div",{className:"now-playing__artist",children:b.artists[0].name}),Object(o.jsx)("button",{onClick:()=>j.previousTrack(),children:"<<"}),Object(o.jsx)("button",{onClick:()=>j.togglePlay(),children:i?"PLAY":"PAUSE"}),Object(o.jsx)("button",{onClick:()=>j.nextTrack(),children:">>"})]})]}):Object(o.jsxs)("div",{style:{marginTop:100},children:[Object(o.jsx)("h1",{style:{color:"white"},children:"Composer POC"}),Object(o.jsx)("h2",{style:{color:"white"},children:"Tap on any track to start playback."})]})}),Object(o.jsxs)("div",{style:{backgroundColor:"#333",padding:"8px 0 8px 16px",position:"fixed",top:300,width:"100%"},children:[Object(o.jsx)("input",{type:"text",placeholder:"paste a Spotify playlist URL here",style:{width:"500px"},onChange:e=>{k(e.target.value);const t=new URL(e.target.value);c(t.pathname.split("/").pop())},value:w}),Object(o.jsxs)("h3",{style:{color:"#44c767"},children:["Playlist: ",m.name," by ",m.owner]})]})]}),Object(o.jsx)("div",{className:"playlist",children:O.map(((e,t)=>{var s;return Object(o.jsxs)("div",{className:"playlist-track",onClick:()=>(async e=>{if(!j)return;401===(await fetch(`https://api.spotify.com/v1/me/player/play?device_id=${x}`,{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({context_uri:`spotify:playlist:${n}`,offset:{position:e}})})).status&&(console.error("Token expired. redirecting to login"),window.location.href="/auth/login")})(t),children:[Object(o.jsx)("img",{src:null===(s=e.track.album.images[0])||void 0===s?void 0:s.url,className:"album-cover",alt:"album cover"}),Object(o.jsxs)("div",{className:"track-info",children:[Object(o.jsx)("div",{className:"track-name",children:e.track.name}),Object(o.jsx)("div",{className:"track-artist",children:e.track.artists[0].name})]})]},t)}))})]})};var d=function(){return Object(o.jsx)("div",{className:"App",children:Object(o.jsx)("header",{className:"App-header",children:Object(o.jsx)("button",{onClick:()=>window.location.href="/auth/login",children:"Login with Spotify"})})})};a(9);var p=function(){const[e,t]=Object(s.useState)(""),[a,n]=Object(s.useState)("1fMkI1ZT6gBkVgW3T3s3YM");return Object(s.useEffect)((()=>{!async function(){const e=await fetch("/auth/token"),a=await e.json();t(a.access_token)}()}),[]),Object(o.jsx)(o.Fragment,{children:""===e?Object(o.jsx)(d,{}):Object(o.jsx)(l,{token:e,playlistId:a,setPlaylistId:n})})};a(10);i.a.render(Object(o.jsx)(n.a.StrictMode,{children:Object(o.jsx)(p,{})}),document.getElementById("root"))},9:function(e,t,a){}},[[11,1,2]]]);
//# sourceMappingURL=main.97f546d4.chunk.js.map